"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5919],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=s(n),d=a,k=m["".concat(p,".").concat(d)]||m[d]||u[d]||o;return n?r.createElement(k,i(i({ref:t},c),{},{components:n})):r.createElement(k,i({ref:t},c))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5244:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=["components"],l={},p=void 0,s={unversionedId:"react/mobx",id:"react/mobx",title:"mobx",description:"MobX \u63d0\u4f9b\u4e86\u4f18\u5316\u5e94\u7528\u72b6\u6001\u4e0e React \u7ec4\u4ef6\u540c\u6b65\u7684\u673a\u5236\uff0c\u8fd9\u79cd\u673a\u5236\u5c31\u662f\u4f7f\u7528\u54cd\u5e94\u5f0f\u865a\u62df\u4f9d\u8d56\u72b6\u6001\u56fe\u8868\uff0c\u5b83\u53ea\u6709\u5728\u771f\u6b63\u9700\u8981\u7684\u65f6\u5019\u624d\u66f4\u65b0\u5e76\u4e14\u6c38\u8fdc\u4fdd\u6301\u662f\u6700\u65b0\u7684\u3002",source:"@site/docs/react/mobx.md",sourceDirName:"react",slug:"/react/mobx",permalink:"/docs/react/mobx",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/react/mobx.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ReactRedux",permalink:"/docs/react/ReactRedux"},next:{title:"\u57fa\u7840",permalink:"/docs/typescript/\u57fa\u7840"}},c={},u=[{value:"\u6982\u5ff5",id:"\u6982\u5ff5",level:2},{value:"Observable state",id:"observable-state",level:2},{value:"Computed values",id:"computed-values",level:3},{value:"Reactions",id:"reactions",level:3},{value:"React\u7ec4\u4ef6",id:"react\u7ec4\u4ef6",level:4},{value:"\u81ea\u5b9a\u4e49reactions",id:"\u81ea\u5b9a\u4e49reactions",level:4},{value:"Actions",id:"actions",level:3},{value:"<code>Mobx</code>\u8981\u70b9",id:"mobx\u8981\u70b9",level:2},{value:"1. \u5b9a\u4e49\u72b6\u6001\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf",id:"1-\u5b9a\u4e49\u72b6\u6001\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf",level:3},{value:"2. \u521b\u5efa\u89c6\u56fe\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf",id:"2-\u521b\u5efa\u89c6\u56fe\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf",level:3},{value:"3. \u66f4\u6539\u72b6\u6001",id:"3-\u66f4\u6539\u72b6\u6001",level:3},{value:"API",id:"api",level:2},{value:"observable(value)",id:"observablevalue",level:4},{value:"MobXProviderContext",id:"mobxprovidercontext",level:4},{value:"React \u7ec4\u4ef6\u7684 <code>observer</code> \u88c5\u9970\u5668",id:"react-\u7ec4\u4ef6\u7684-observer-\u88c5\u9970\u5668",level:4},{value:"\u5b9e\u7528\u5de5\u5177",id:"\u5b9e\u7528\u5de5\u5177",level:3},{value:"\u7f16\u5199\u5f02\u6b65Actions",id:"\u7f16\u5199\u5f02\u6b65actions",level:3},{value:"Promises",id:"promises",level:4},{value:"ruInAction\u5de5\u5177\u51fd\u6570",id:"ruinaction\u5de5\u5177\u51fd\u6570",level:4},{value:"<code>async/await</code>",id:"asyncawait",level:4},{value:"flows",id:"flows",level:4}],m={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"MobX")," \u63d0\u4f9b\u4e86\u4f18\u5316\u5e94\u7528\u72b6\u6001\u4e0e React \u7ec4\u4ef6\u540c\u6b65\u7684\u673a\u5236\uff0c\u8fd9\u79cd\u673a\u5236\u5c31\u662f\u4f7f\u7528\u54cd\u5e94\u5f0f\u865a\u62df\u4f9d\u8d56\u72b6\u6001\u56fe\u8868\uff0c\u5b83\u53ea\u6709\u5728\u771f\u6b63\u9700\u8981\u7684\u65f6\u5019\u624d\u66f4\u65b0\u5e76\u4e14\u6c38\u8fdc\u4fdd\u6301\u662f\u6700\u65b0\u7684\u3002"),(0,o.kt)("h2",{id:"\u6982\u5ff5"},"\u6982\u5ff5"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'import React from "react";\nimport { render } from "react-dom";\nimport { makeAutoObservable } from "mobx";\nimport { observer } from "mobx-react-lite";\n\nclass AppState {\n  timer = 0;\n\n  constructor() {\n    makeAutoObservable(this);\n    setInterval(() => {\n      this.timer += 1;\n    }, 1000);\n  }\n\n  reset = () => {\n    this.timer = 0;\n  };\n}\n\nconst TimerView = observer(({ appState }) => (\n  <button onClick={appState.reset}>Seconds passed: {appState.timer}</button>\n));\n\nrender(\n  <div>\n    <TimerView appState={new AppState()} />\n  </div>,\n  document.getElementById("root")\n);\n\n')),(0,o.kt)("h2",{id:"observable-state"},"Observable state"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"Mobx"),"\u4e3a\u73b0\u6709\u7684\u6570\u636e\u7ed3\u6784(\u5982\u5bf9\u8c61\uff0c\u6570\u7ec4\u548c\u7c7b\u5b9e\u4f8b)\u6dfb\u52a0\u4e86\u53ef\u89c2\u5bdf\u7684\u529f\u80fd.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u901a\u8fc7\u4f7f\u7528@observable\u88c5\u9970\u5668\u6765\u7ed9\u4f60\u7684\u5c5e\u6027\u6dfb\u52a0\u6ce8\u89e3"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'import { observable } from "mobx";\n\nclass Todo {\n    id = Math.random();\n    @observable title = "";\n    @observable finished = false;\n}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"observer")," \u51fd\u6570/\u88c5\u9970\u5668\u53ef\u4ee5\u7528\u6765\u5c06 React \u7ec4\u4ef6\u8f6c\u53d8\u6210\u54cd\u5e94\u5f0f\u7ec4\u4ef6"),(0,o.kt)("p",null,"\u4f55\u65f6\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"observer")),(0,o.kt)("h3",{id:"computed-values"},"Computed values"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"Mobx"),"\u4f60\u53ef\u4ee5\u5b9a\u4e49\u5728\u76f8\u5173\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\u81ea\u52a8\u66f4\u65b0\u7684\u503c\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u901a\u8fc7\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"@computed"),"\u88c5\u9970\u5668\u6216\u8005\u5229\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"(extend)Observable"),"\u65f6\u8c03\u7528\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"getter/setter"),"\u51fd\u6570\u6765\u8fdb\u884c\u4f7f\u7528"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"class TodoList {\n    @observable todos = [];\n    @computed get unfinishedTodoCount() {\n        return this.todos.filter(todo => !todo.finished).length;\n    }\n}\n")),(0,o.kt)("h3",{id:"reactions"},"Reactions"),(0,o.kt)("p",null,"Reactions\u548c\u8ba1\u7b97\u5f88\u50cf\uff0c\u4f46\u5b83\u4e0d\u662f\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u503c\uff0c\u800c\u662f\u4f1a\u4ea7\u751f\u4e00\u4e9b\u526f\u4f5c\u7528\uff0c\u6bd4\u5982\u6253\u5370\u5230\u63a7\u5236\u53f0\u3001\u7f51\u7edc\u8bf7\u6c42\u7b49\u7b49"),(0,o.kt)("h4",{id:"react\u7ec4\u4ef6"},"React\u7ec4\u4ef6"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5982\u679c\u4f7f\u7528react\uff0c\u53ef\u4ee5\u628a\u65e0\u72b6\u6001\u51fd\u6570\u7ec4\u4ef6\u53d8\u6210\u54cd\u5e94\u5f0f\u7ec4\u4ef6\uff0c\u65b9\u6cd5\u662f\u5728\u7ec4\u4ef6\u4e0a\u6dfb\u52a0observer\u51fd\u6570/\u88c5\u9970\u5668\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"observer"),"\u7531 ",(0,o.kt)("inlineCode",{parentName:"p"},"mobx-react")," \u5305\u63d0\u4f9b")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"observer"),"\u4f1a\u5c06React\uff08\u51fd\u6570\uff09\u7ec4\u4ef6\u8f6c\u6362\u4e3a\u5b83\u4eec\u9700\u8981\u6e32\u67d3\u7684\u6570\u636e\u7684\u884d\u751f\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"Mobx"),"\u4f1a\u786e\u4fdd\u7ec4\u4ef6\u603b\u662f\u5728\u9700\u8981\u7684\u65f6\u5019\u91cd\u65b0\u6e32\u67d3\u3002"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import React, {Component} from 'react';\nimport ReactDOM from 'react-dom';\nimport {observer} from 'mobx-react';\n\n@observer\nclass TodoListView extends Component {\n    render() {\n        return <div>\n            <ul>\n                {this.props.todoList.todos.map(todo =>\n                    <TodoView todo={todo} key={todo.id} />\n                )}\n            </ul>\n            Tasks left: {this.props.todoList.unfinishedTodoCount}\n        </div>\n    }\n}\n\nconst TodoView = observer(({todo}) =>\n    <li>\n        <input\n            type=\"checkbox\"\n            checked={todo.finished}\n            onClick={() => todo.finished = !todo.finished}\n        />{todo.title}\n    </li>\n)\n\nconst store = new TodoList();\nReactDOM.render(<TodoListView todoList={store} />, document.getElementById('mount'));\n\n")),(0,o.kt)("h4",{id:"\u81ea\u5b9a\u4e49reactions"},"\u81ea\u5b9a\u4e49reactions"),(0,o.kt)("p",null,"\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"autorun"),"\u3001",(0,o.kt)("inlineCode",{parentName:"p"},"reaction"),"\u3001",(0,o.kt)("inlineCode",{parentName:"p"},"when"),"\u51fd\u6570\u5373\u53ef\u7b80\u5355\u7684\u521b\u5efa\u81ea\u5b9a\u4e49reactions\u3002"),(0,o.kt)("p",null,"\u6bcf\u5f53",(0,o.kt)("inlineCode",{parentName:"p"},"unfinishTodoCount"),"\u7684\u6570\u91cf\u53d1\u751f\u53d8\u5316\u7684\u65f6\u5019\uff0c\u4e0b\u9762\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"authorun"),"\u5c31\u4f1a\u6253\u5370\u65e5\u5fd7\u6d88\u606f\u3002"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},'autorun(() => {\n    console.log("Tasks left: " + todos.unfinishedTodoCount)\n}\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"Mobx"),"\u4f1a\u5bf9\u5728\u6267\u884c\u8ddf\u8e2a\u51fd\u6570\u671f\u95f4\u8bfb\u53d6\u7684\u4efb\u4f55\u53ef\u89c2\u5bdf\u5c5e\u6027\u505a\u51fa\u53cd\u5e94\u3002"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u8ba1\u7b97\u503c")," \u662f\u81ea\u52a8\u54cd\u5e94\u72b6\u6001\u53d8\u5316\u7684",(0,o.kt)("strong",{parentName:"p"},"\u503c"),"\u3002 ",(0,o.kt)("strong",{parentName:"p"},"\u53cd\u5e94")," \u662f\u81ea\u52a8\u54cd\u5e94\u72b6\u6001\u53d8\u5316\u7684",(0,o.kt)("strong",{parentName:"p"},"\u526f\u4f5c\u7528")),(0,o.kt)("h3",{id:"actions"},"Actions"),(0,o.kt)("p",null,"\u5e94\u8be5\u5bf9\u4fee\u6539\u72b6\u6001\u7684\u51fd\u6570\u4f7f\u7528action"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u7ed1\u5b9a\u7684action")),(0,o.kt)("p",null,"action\u88c5\u9970\u5668/\u51fd\u6570\u9075\u5faajs\u4e2d\u6807\u51c6\u7684\u7ed1\u5b9a\u89c4\u5219\u3002\u4f46\u662f\uff0c",(0,o.kt)("inlineCode",{parentName:"p"},"action.bound"),"\u53ef\u4ee5\u7528\u6765\u81ea\u52a8\u7684\u5c06\u52a8\u4f5c\u7ed1\u5b9a\u5230\u76ee\u6807\u5bf9\u8c61\u3002"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"\u6ce8\u610f: ",(0,o.kt)("inlineCode",{parentName:"em"},"action.bound"),"\u4e0d\u8981\u548c\u7bad\u5934\u51fd\u6570\u4e00\u8d77\u4f7f\u7528\uff1b\u7bad\u5934\u51fd\u6570\u5df2\u7ecf\u662f\u7ed1\u5b9a\u8fc7\u7684\u5e76\u4e14\u4e0d\u80fd\u91cd\u65b0\u7ed1\u5b9a\u3002")),(0,o.kt)("h2",{id:"mobx\u8981\u70b9"},(0,o.kt)("inlineCode",{parentName:"h2"},"Mobx"),"\u8981\u70b9"),(0,o.kt)("h3",{id:"1-\u5b9a\u4e49\u72b6\u6001\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf"},"1. \u5b9a\u4e49\u72b6\u6001\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf"),(0,o.kt)("p",null,"\u786e\u4fdd\u5c5e\u6027\u6253\u4e0a",(0,o.kt)("inlineCode",{parentName:"p"},"mobx"),"\u7684\u6807\u8bb0\u4f7f\u5f97\u4ed6\u4eec\u53d8\u5f97\u53ef\u89c2\u5bdf\u7684"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { observable } from 'mobx'\nconst appState = observable({\n    timer: 0\n})\n\n// \u6216\u8005\n@observable appState = {\n    timer: 0\n}\n")),(0,o.kt)("h3",{id:"2-\u521b\u5efa\u89c6\u56fe\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf"},"2. \u521b\u5efa\u89c6\u56fe\u5e76\u4f7f\u5176\u53ef\u89c2\u5bdf"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\u6211\u4eec\u7684",(0,o.kt)("inlineCode",{parentName:"li"},"appState"),"\u8fd8\u6ca1\u6709\u89c2\u5bdf\u5230\u4efb\u4f55\u7684\u4e1c\u897f\uff0c\u521b\u5efa\u89c6\u56fe\uff0c\u5f53appState\u4e2d\u76f8\u5173\u6570\u636e\u53d1\u751f\u53d8\u5316\u65f6\u89c6\u56fe\u4f1a\u81ea\u52a8\u66f4\u65b0\u3002")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import {observer} from 'mobx-react';\n\n@observer\nclass TimerView extends React.Component {\n    render() {\n        return (\n            <button onClick={this.onReset.bind(this)}>\n                Seconds passed: {this.props.appState.timer}\n            </button>\n        );\n    }\n\n    onReset() {\n        this.props.appState.resetTimer();\n    }\n};\n\nReactDOM.render(<TimerView appState={appState} />, document.body);\n")),(0,o.kt)("h3",{id:"3-\u66f4\u6539\u72b6\u6001"},"3. \u66f4\u6539\u72b6\u6001"),(0,o.kt)("p",null,"\u4f7f\u7528",(0,o.kt)("inlineCode",{parentName:"p"},"observable"),"\u6765\u88c5\u9970",(0,o.kt)("strong",{parentName:"p"},"\u72b6\u6001\u548c\u89c6\u56fe"),"\uff0c\u8db3\u4ee5\u8ba9mobx\u68c0\u6d4b\u6240\u6709\u5173\u7cfb\u4e86\u3002"),(0,o.kt)("h2",{id:"api"},"API"),(0,o.kt)("h4",{id:"observablevalue"},"observable(value)"),(0,o.kt)("p",null,"\u7528\u6cd5"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"observable(value)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"@observable classProperty = value"))),(0,o.kt)("p",null,"Observable \u503c\u53ef\u4ee5\u662fJS\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3001\u5f15\u7528\u7c7b\u578b\u3001\u666e\u901a\u5bf9\u8c61\u3001\u7c7b\u5b9e\u4f8b\u3001\u6570\u7ec4\u548c\u6620\u5c04\u3002"),(0,o.kt)("h4",{id:"mobxprovidercontext"},"MobXProviderContext"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { MobXProviderContext } from 'mobx-react';\nimport React from 'react';\n\nexport function useStores() {\n  return React.useContext(MobXProviderContext);\n}\n\nexport function useInjectedStore<T =unknown>(name: string):T {\n  let mobxContext = React.useContext(MobXProviderContext);\n  return mobxContext[name] || null;\n}\n")),(0,o.kt)("h4",{id:"react-\u7ec4\u4ef6\u7684-observer-\u88c5\u9970\u5668"},"React \u7ec4\u4ef6\u7684 ",(0,o.kt)("inlineCode",{parentName:"h4"},"observer")," \u88c5\u9970\u5668"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"observer")),(0,o.kt)("p",null,"\u53ef\u4ee5\u7528\u4f5c\u5305\u88f9React\u7ec4\u4ef6\u7684\u9ad8\u9636\u7ec4\u4ef6\u3002\u5728\u7ec4\u4ef6\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"render"),"\u51fd\u6570\u4e2d\u7684",(0,o.kt)("strong",{parentName:"p"},"\u4efb\u4f55\u5df2\u4f7f\u7528\u7684observable"),"\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u7ec4\u4ef6\u90fd\u4f1a\u81ea\u52a8\u91cd\u65b0\u6e32\u67d3\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"autorun")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"autorun"),"\u8d1f\u8d23\u8fd0\u884c\u6240\u63d0\u4f9b\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"sideEffect"),"\u5e76\u8ffd\u8e2a\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"sideEffect"),"\u8fd0\u884c\u671f\u95f4\u8bbf\u95ee\u8fc7\u7684observable\u7684\u72b6\u6001\u3002")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u5c06\u6765\u5982\u679c\u6709\u5176\u4e2d\u4e00\u4e2a\u5df2\u4f7f\u7528\u7684 observable \u53d1\u751f\u53d8\u5316\uff0c\u540c\u6837\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"sideEffect"),"\u4f1a\u518d\u8fd0\u884c\u4e00\u904d\u3002 ",(0,o.kt)("inlineCode",{parentName:"p"},"autorun")," \u8fd4\u56de\u4e00\u4e2a\u6e05\u7406\u51fd\u6570\u7528\u6765\u53d6\u6d88\u526f\u4f5c\u7528\u3002"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"when")),(0,o.kt)("p",null,"\u7528\u6cd5\uff1a ",(0,o.kt)("inlineCode",{parentName:"p"},"when(() => condition, () => { sideEffect }, options)")),(0,o.kt)("p",null," ",(0,o.kt)("inlineCode",{parentName:"p"},"condition")," \u8868\u8fbe\u5f0f\u4f1a\u81ea\u52a8\u54cd\u5e94\u4efb\u4f55\u5b83\u6240\u4f7f\u7528\u7684 observable\u3002 \u4e00\u65e6\u8868\u8fbe\u5f0f\u8fd4\u56de\u7684\u662f\u771f\u503c\uff0c\u526f\u4f5c\u7528\u51fd\u6570\u4fbf\u4f1a\u7acb\u5373\u8c03\u7528\uff0c\u4f46\u53ea\u4f1a\u8c03\u7528\u4e00\u6b21\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\u6ce8\u610f:")," ",(0,o.kt)("em",{parentName:"p"},"\u526f\u4f5c\u7528\u51fd\u6570")," (\u7b2c\u4e8c\u4e2a\u53c2\u6570) \u5176\u5b9e\u662f\u53ef\u9009\u7684\u3002\u5982\u679c\u4e0d\u63d0\u4f9b\u526f\u4f5c\u7528\u51fd\u6570\u7684\u8bdd\uff0c\u5c06\u8fd4\u56de\u4e00\u4e2a\u53ef\u53d6\u6d88\u7684 promise (\u5373\u5177\u6709 ",(0,o.kt)("inlineCode",{parentName:"p"},"cancle()")," \u65b9\u6cd5\u7684 promise)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"when")," \u8fd4\u56de\u6e05\u7406\u5668\u4ee5\u5c3d\u65e9\u5730\u53d6\u6d88\u64cd\u4f5c\u3002"),(0,o.kt)("p",null,"\u5982\u679c\u6ca1\u6709\u7ed9 ",(0,o.kt)("inlineCode",{parentName:"p"},"when")," \u4f20\u9012\u526f\u4f5c\u7528\u51fd\u6570\u7684\u8bdd\uff0c\u5b83\u5c06\u8fd4\u56de\u4e00\u4e2a\u53ef\u4ee5\u7b49\u5f85\u6761\u4ef6\u7ed3\u675f\u7684 promise \u3002"),(0,o.kt)("h3",{id:"\u5b9e\u7528\u5de5\u5177"},"\u5b9e\u7528\u5de5\u5177"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Provider")),(0,o.kt)("p",null,"\u53ef\u4ee5\u7528\u6765\u4f7f\u7528React\u7684context\u673a\u5236\u6765\u4f20\u9012store\u7ed9\u5b50\u7ec4\u4ef6\u3002"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"inject")),(0,o.kt)("p",null,"\u76f8\u5f53\u4e8eProvider\u7684\u9ad8\u9636\u7ec4\u4ef6\u3002\u53ef\u4ee5\u7528\u6765\u4eceReact\u7684context\u4e2d\u6311\u9009store\u4f5c\u4e3aprop\u4f20\u9012\u7ed9\u76ee\u6807\u7ec4\u4ef6\u3002"),(0,o.kt)("h3",{id:"\u7f16\u5199\u5f02\u6b65actions"},"\u7f16\u5199\u5f02\u6b65Actions"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"action"),"\u5305\u88c5/\u88c5\u9970\u5668\u53ea\u4f1a\u5bf9\u5f53\u524d\u8fd0\u884c\u7684\u51fd\u6570\u505a\u51fa\u53cd\u5e94\uff0c\u800c\u4e0d\u4f1a\u5bf9\u5f53\u524d\u8fd0\u884c\u51fd\u6570\u6240\u8c03\u7528\u7684\u51fd\u6570\u4f5c\u51fa\u53cd\u5e94")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"\u8fd9\u610f\u5473\u7740\u5982\u679caction\u4e2d\u5b58\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"setTimeout"),"\u3001promise\u7684",(0,o.kt)("inlineCode",{parentName:"p"},"then"),"\u6216\u8005",(0,o.kt)("inlineCode",{parentName:"p"},"async"),"\u8bed\u53e5\uff0c\u5e76\u4e14\u5728\u56de\u8c03\u51fd\u6570\u4e2d\u67d0\u4e9b\u72b6\u6001\u6539\u53d8\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e9b\u56de\u8c03\u51fd\u6570\u4e5f\u5e94\u8be5\u5305\u88c5\u5728",(0,o.kt)("inlineCode",{parentName:"p"},"action"),"\u4e2d\u3002"))),(0,o.kt)("h4",{id:"promises"},"Promises"),(0,o.kt)("h4",{id:"ruinaction\u5de5\u5177\u51fd\u6570"},"ruInAction\u5de5\u5177\u51fd\u6570"),(0,o.kt)("h4",{id:"asyncawait"},(0,o.kt)("inlineCode",{parentName:"h4"},"async/await")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'mobx.configure({ enforceActions: true })\n\nclass Store {\n    @observable githubProjects = []\n    @observable state = "pending" // "pending" / "done" / "error"\n\n    @action\n    async fetchProjects() {\n        this.githubProjects = []\n        this.state = "pending"\n        try {\n            const projects = await fetchGithubProjectsSomehow()\n            const filteredProjects = somePreprocessing(projects)\n            // await \u4e4b\u540e\uff0c\u518d\u6b21\u4fee\u6539\u72b6\u6001\u9700\u8981\u52a8\u4f5c:\n            runInAction(() => {\n                this.state = "done"\n                this.githubProjects = filteredProjects\n            })\n        } catch (error) {\n            runInAction(() => {\n                this.state = "error"\n            })\n        }\n    }\n}\n\n')),(0,o.kt)("h4",{id:"flows"},"flows"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'mobx.configure({ enforceActions: true })\n\nclass Store {\n    @observable githubProjects = []\n    @observable state = "pending"\n\n    fetchProjects = flow(function * () { // <- \u6ce8\u610f*\u53f7\uff0c\u8fd9\u662f\u751f\u6210\u5668\u51fd\u6570\uff01\n        this.githubProjects = []\n        this.state = "pending"\n        try {\n            const projects = yield fetchGithubProjectsSomehow() // \u7528 yield \u4ee3\u66ff await\n            const filteredProjects = somePreprocessing(projects)\n            // \u5f02\u6b65\u4ee3\u7801\u5757\u4f1a\u88ab\u81ea\u52a8\u5305\u88c5\u6210\u52a8\u4f5c\u5e76\u4fee\u6539\u72b6\u6001\n            this.state = "done"\n            this.githubProjects = filteredProjects\n        } catch (error) {\n            this.state = "error"\n        }\n    })\n}\n\n')))}d.isMDXComponent=!0}}]);